{% load static %}
<!DOCTYPE html>
<html>

<head>
  <title>Django Girls blog</title>
  <!-- CSS Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <!-- Vos autres CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lobster&subset=latin,latin-ext">
  <link rel="stylesheet" href="{% static 'css/blog.css' %}">
  <style>
    #tunisia-map {
      height: 500px;
      width: 100%;
      margin: 30px 0;
      border: 1px solid #ddd;
      border-radius: 8px;
    }
  </style>
</head>

<body>
  <header class="page-header">
    <div class="container">
      <h1><a href="/">Django Girls Blog</a></h1>
      <a href="{% url 'post_new' %}" class="btn btn-primary">
        <i class="fas fa-pen"></i> Écrire
      </a>
    </div>
  </header>

  <main class="container">
    <div class="row">
      <div class="col">
        {% for post in posts %}
        <article class="post">
          <time class="date">{{ post.published_date }}</time>
          <h2><a href="{% url 'post_detail' pk=post.pk %}">{{ post.title }}</a></h2>
          <p>{{ post.text|linebreaksbr }}</p>
        </article>
        {% endfor %}
      </div>
    </div>
  </main>

  <!-- SECTION CARTE TUNISIE - Ajoutée ici -->
  <div class="container mt-5">
    <h3 class="text-center mb-4">Carte de la Tunisie</h3>
    <div id="tunisia-map"></div>
  </div>

  <!-- Scripts JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    // Initialisation de la carte Tunisie
    document.addEventListener('DOMContentLoaded', function () {
      var map = L.map('tunisia-map').setView([34.0, 9.0], 7);

      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'
      }).addTo(map);

      // Création d'un marqueur personnalisé
      var customIcon = L.icon({
        iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png',
        iconSize: [25, 41],  // Taille de l'icône
        iconAnchor: [12, 41],  // Point d'ancrage
        popupAnchor: [1, -34]  // Position du popup
      });

      // Ajout du marqueur (exemple : Tunis)
      var locations = [
        { name: "Tunis", coords: [36.8065, 10.1815], color: "black" },
        { name: "Sfax", coords: [34.7406, 10.7603], color: "green" },
        { name: "Désert", coords: [32.3182, 9.4766], color: "orange" }
      ];

      locations.forEach(function (loc) {
        var icon = new L.Icon({
          iconUrl: `https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-${loc.color}.png`,
          shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png',
          iconSize: [25, 41],
          iconAnchor: [12, 41],
          shadowSize: [41, 41]
        });

        L.marker(loc.coords, { icon: icon })
          .addTo(map)
          .bindPopup(loc.name);
      });
      // Ajout des principales villes
      var villes = [
        { nom: "Sousse", coords: [35.8254, 10.6369] },
        { nom: "Kairouan", coords: [35.6712, 10.1006] }
      ];

      villes.forEach(function (ville) {
        L.marker(ville.coords).addTo(map)
          .bindPopup("<b>" + ville.nom + "</b>");
      });
    });
  </script>
</body>

</html>